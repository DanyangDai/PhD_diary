<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Daidai">
<meta name="dcterms.date" content="2023-06-30">

<title>My PhD Journey Documentation - There is always more to do</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/kidney.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<meta name="twitter:title" content="My PhD Journey Documentation - There is always more to do">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://danyangdai.github.io/PhD_diary//images/twitter-card.png">
<meta name="twitter:creator" content="@Daidaidai2014">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">My PhD Journey Documentation</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/DanyangDai/PhD_diary" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub repo">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/Daidaidai2014" rel="" target=""><i class="bi bi-twitter" role="img" aria-label="Daidai's Twitter">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml" rel="" target=""><i class="bi bi-rss-fill" role="img" aria-label="RSS">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">There is always more to do</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">diary</div>
                <div class="quarto-category">writting</div>
                <div class="quarto-category">modeling</div>
                <div class="quarto-category">biostatistics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Daidai </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 30, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#starting-with-good-news" id="toc-starting-with-good-news" class="nav-link active" data-scroll-target="#starting-with-good-news">Starting with Good News</a>
  <ul class="collapse">
  <li><a href="#very-first-paper-published-association-of-country-income-level-with-the-characteristics-and-outcomes-of-critically-ill-patients-hospitalized-with-acute-kidney-injury-and-covid-19" id="toc-very-first-paper-published-association-of-country-income-level-with-the-characteristics-and-outcomes-of-critically-ill-patients-hospitalized-with-acute-kidney-injury-and-covid-19" class="nav-link" data-scroll-target="#very-first-paper-published-association-of-country-income-level-with-the-characteristics-and-outcomes-of-critically-ill-patients-hospitalized-with-acute-kidney-injury-and-covid-19">Very first paper published: Association of Country Income Level With the Characteristics and Outcomes of Critically Ill Patients Hospitalized With Acute Kidney Injury and COVID-19</a></li>
  <li><a href="#very-first-conference-presentation-accepted" id="toc-very-first-conference-presentation-accepted" class="nav-link" data-scroll-target="#very-first-conference-presentation-accepted">Very first conference presentation accepted!</a></li>
  </ul></li>
  <li><a href="#phd-progress" id="toc-phd-progress" class="nav-link" data-scroll-target="#phd-progress">PhD progress</a>
  <ul class="collapse">
  <li><a href="#drafted-and-pretty-much-finalised-ethic-study-protocal-to-submit-to-hear" id="toc-drafted-and-pretty-much-finalised-ethic-study-protocal-to-submit-to-hear" class="nav-link" data-scroll-target="#drafted-and-pretty-much-finalised-ethic-study-protocal-to-submit-to-hear">Drafted and pretty much finalised Ethic study protocal to submit to HEAR</a></li>
  <li><a href="#omicron-aki-paper-progress" id="toc-omicron-aki-paper-progress" class="nav-link" data-scroll-target="#omicron-aki-paper-progress">Omicron AKI paper progress</a></li>
  </ul></li>
  <li><a href="#some-thoughs-on-modeling-and-statistics-in-the-medical-setting" id="toc-some-thoughs-on-modeling-and-statistics-in-the-medical-setting" class="nav-link" data-scroll-target="#some-thoughs-on-modeling-and-statistics-in-the-medical-setting">Some thoughs on modeling and statistics in the medical setting</a>
  <ul class="collapse">
  <li><a href="#variable-transfomation" id="toc-variable-transfomation" class="nav-link" data-scroll-target="#variable-transfomation">Variable transfomation</a></li>
  <li><a href="#missingness-and-imputation" id="toc-missingness-and-imputation" class="nav-link" data-scroll-target="#missingness-and-imputation">Missingness and imputation</a></li>
  </ul></li>
  <li><a href="#life-updates" id="toc-life-updates" class="nav-link" data-scroll-target="#life-updates">Life updates</a>
  <ul class="collapse">
  <li><a href="#got-my-roof-top-garden-set-up" id="toc-got-my-roof-top-garden-set-up" class="nav-link" data-scroll-target="#got-my-roof-top-garden-set-up">Got my roof top garden set up!</a></li>
  <li><a href="#first-time-on-the-ferry" id="toc-first-time-on-the-ferry" class="nav-link" data-scroll-target="#first-time-on-the-ferry">First time on the Ferry!</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/DanyangDai/PhD_diary/edit/main/posts/12-PhD-more/index.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/DanyangDai/PhD_diary/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="starting-with-good-news" class="level1">
<h1>Starting with Good News</h1>
<p>It has been a while since I documented my PhD journey and I would like to start with sharing some great news.</p>
<section id="very-first-paper-published-association-of-country-income-level-with-the-characteristics-and-outcomes-of-critically-ill-patients-hospitalized-with-acute-kidney-injury-and-covid-19" class="level2">
<h2 class="anchored" data-anchor-id="very-first-paper-published-association-of-country-income-level-with-the-characteristics-and-outcomes-of-critically-ill-patients-hospitalized-with-acute-kidney-injury-and-covid-19">Very first paper published: <a href="https://doi.org/10.1016/j.ekir.2023.05.015">Association of Country Income Level With the Characteristics and Outcomes of Critically Ill Patients Hospitalized With Acute Kidney Injury and COVID-19</a></h2>
<p>Helping out on this paper helped me realized how long it takes to publish a paper. I have now lowered my expectation on the number of papers I might be able to publish during my PhD time.</p>
</section>
<section id="very-first-conference-presentation-accepted" class="level2">
<h2 class="anchored" data-anchor-id="very-first-conference-presentation-accepted">Very first conference presentation accepted!</h2>
<p>I am not only going to the <a href="https://www.asc2023.org">ASC AND OZCOTS 2023</a> end of the year but also presenting part of our <a href="https://learnr.numbat.space">LearnR</a> project. I will be sharing the design and some insights into our self-paced introduction to R. I am going to be focusing on giving students the confidence and skills to learn R themselves.</p>
</section>
</section>
<section id="phd-progress" class="level1">
<h1>PhD progress</h1>
<section id="drafted-and-pretty-much-finalised-ethic-study-protocal-to-submit-to-hear" class="level2">
<h2 class="anchored" data-anchor-id="drafted-and-pretty-much-finalised-ethic-study-protocal-to-submit-to-hear">Drafted and pretty much finalised Ethic study protocal to submit to HEAR</h2>
<p>After a couple time of comments from my principle supervisor, it looks good to go now. Just need the other two supervisors to prove the study protocol. Hoping to start this long road of Ethic application as soon as possible.</p>
</section>
<section id="omicron-aki-paper-progress" class="level2">
<h2 class="anchored" data-anchor-id="omicron-aki-paper-progress">Omicron AKI paper progress</h2>
<p>Competed data cleaning and identifying AKI patients. Updated table 1. Survival analysis and regression analysis.</p>
<p>Looking forward to sharing some of the main findings with all the supervisors.</p>
</section>
</section>
<section id="some-thoughs-on-modeling-and-statistics-in-the-medical-setting" class="level1">
<h1>Some thoughs on modeling and statistics in the medical setting</h1>
<section id="variable-transfomation" class="level2">
<h2 class="anchored" data-anchor-id="variable-transfomation">Variable transfomation</h2>
<p>It bugs me for a long time on the variables I should be including in my regression analysis. The question I want to answer is that whether Omicron patients have a higher chance of developing AKI compare to pre-Omicron variant.</p>
<p>First, the variables such as blood pressure, sCr, age ect. they are not linear. There is a clear lower and upper bond for these variables. There are a few different ways I could handle this.</p>
<p>Truncated all these variables and bin them. For example, age can be truncated into patients age &lt; 65 and age &gt; 65. Same goes with blood pressure. Systolic blood pressure can be bined from [100,140) to four or five groups. This binning methods is relatively easy to implementation. In R, you can use <code>cut()</code> function to do that. But the downside is that you will lose information on these variables as they are suppose to be continue variables within a certain range but binning will convert them into categorical variables.</p>
<p>Transformations on the variables. If you have a general understanding of which distribution your data is, use QQ plot to compare your data with the potential distribution you have in mind. If not entirely sure about the data, just plot the histogram of the data to have a look at the distribution. Alternatively, use <code>gladder()</code> function from the <code>describedata</code> package to see which transformation is most suitable. This process require judgement on which transformation to make. It would also increase the difficulty on the interpretations on your regression analysis.</p>
<p>Acknowledge on the model misspecification and justify the standard errors with sandwich estimator. Use sandwich estimator to generate robust standard errors would allow for unbiased parameters estimated. I think this would be the method I go with for my analysis. ## Variable selection, simultaneous effect and multicollinearity</p>
<p>Variable selection suggested by my principle supervisor should be driven by the literature which I agree. However, this could create a lot of problems for regression modelling.</p>
<p>There are simultaneous effect with a lot of my predictors and outcome. For example, my dependent variable is AKI positive or not which is binary. I want to include death and icu as controls. Because we know from recent research and my data that Omicron has less severe outcome in terms of lower death rate and lower icu rate. So that controlling for these outcome, whether Omicron variant results in a higher rate of AKI incidents. But we also know that AKI patients has a higher death rate and higher icu rate. Maybe I will use simultaneous causal equations for this.</p>
<p>Multicollinearity is another issue. As pretty much all variables I am including are all somewhat correlated to each other. It’s like common senses that ICU is highly correlated to Death. High White Blood Cell count is associated with inflammation in the body and it can also be correlated with other controls I am including. Still need to work out if this is something I need to worry too much about.</p>
</section>
<section id="missingness-and-imputation" class="level2">
<h2 class="anchored" data-anchor-id="missingness-and-imputation">Missingness and imputation</h2>
<p>Before in Econometrics sitting, I don’t think I have ever needed to worry about NAs. They either don’t exits in my data or they are just automatically handled when modelling because they are very little NAs in the data.</p>
<p>For my current analysis, out of 9000ish patients records, only 3000ish have completed records. With this amount of missingness in my data, I would need to learn what is the most correct way of dealing with it.</p>
<p>The first step is to identify whether the records are missing completely at random (MCAR). This is a very new term for me which I just learnt about reading Regression Modeling Strategies With Applications to Linear Models, Logistic and Ordinal Regression, and Survival Analysis by Frank E. Harrell, Jr.&nbsp;BTW would recommend. It is easy to read. If you decide or know that your missing is completely at random, then not doing anything about them would not introduce bias to your parameter estimates.</p>
<p>To examinate the relationship of your missingness, you can do some regression analysis on the missing variables. i.e.&nbsp;the probability of missing comorbidities records is depended on the country. Alternatively, you can use <code>md.pattern</code> from the <code>mice</code> package to check the relationship between your missing values. If you data if relatively small and have a small number of variables you are looking, use <code>naniar</code> package to explore missing values is also great and easy.</p>
<p>Once decided that your variables aren’t MCAR, need to decide whether it is ok to impute some variables. For instant, I decided not to impute for death, icu, sex and race. Race has a high missingness at 80% and I don’t think the data have the ability to impute race. Same with sex. Sex only has around 2% of missing and I don’t think you can impute whether the patient is male or female. For death and icu, they all have low missing around 2% and I decide not to impute for them.</p>
<p>With <code>mice</code> function, include all variables that you think could help to impute missing values.</p>
<p>I did worry about how validate my regression analysis is going to be with this amount of imputation and model specification problems. We shall see how it goes.</p>
</section>
</section>
<section id="life-updates" class="level1">
<h1>Life updates</h1>
<section id="got-my-roof-top-garden-set-up" class="level2">
<h2 class="anchored" data-anchor-id="got-my-roof-top-garden-set-up">Got my roof top garden set up!</h2>
<p>Mitch got me lights and Pooh bear sign to go on it.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="life_1.png" class="img-fluid figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="life_2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="first-time-on-the-ferry" class="level2">
<h2 class="anchored" data-anchor-id="first-time-on-the-ferry">First time on the Ferry!</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="life_3.png" class="img-fluid figure-img"></p>
</figure>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Proudly supported by <a href="https://www.rstudio.com"><img src="https://www.rstudio.com/wp-content/uploads/2018/10/RStudio-Logo-flat.svg" class="img-fluid" alt="RStudio" width="65"></a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This blog is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>